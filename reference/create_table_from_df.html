<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a Table with a Dataframe — create_table_from_df • pg13</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a Table with a Dataframe — create_table_from_df" />
<meta property="og:description" content="Derive DDL using the data classes of each field in a dataframe. The map between the R data classes and the Postgresql data types can be found at renderCreateTableFromDF. The dataframe can then be appended to the table using appendTable. This method is favorable to a direct call to writeTable because in some cases, future appends to the table may not adhere to the data definitions created at the time of writing. For example, writeTable defaults to VARCHAR(255) for all character classes whereas future appends may contain text greater than 255 characters, resulting in error. This function rolls all character classes to TEXT data types instead." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pg13</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/meerapatelmd/pg13/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a Table with a Dataframe</h1>
    <small class="dont-index">Source: <a href='https://github.com/meerapatelmd/pg13/blob/master/R/create.R'><code>R/create.R</code></a></small>
    <div class="hidden name"><code>create_table_from_df.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Derive DDL using the data classes of each field in a dataframe. The map between the R data classes and the Postgresql data types can be found at <code>renderCreateTableFromDF</code>. The dataframe can then be appended to the table using <code><a href='appendTable.html'>appendTable</a></code>. This method is favorable to a direct call to <code><a href='writeTable.html'>writeTable</a></code> because in some cases, future appends to the table may not adhere to the data definitions created at the time of writing. For example, <code><a href='writeTable.html'>writeTable</a></code> defaults to <code>VARCHAR(255)</code> for all character classes whereas future appends may contain text greater than 255 characters, resulting in error. This function rolls all character classes to <code>TEXT</code> data types instead.</p>
    </div>

    <pre class="usage"><span class='fu'>create_table_from_df</span><span class='op'>(</span>
  <span class='va'>conn</span>,
  <span class='va'>conn_fun</span>,
  <span class='va'>schema</span>,
  <span class='va'>table_name</span>,
  if_not_exists <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>data</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  render_sql <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>


    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other create functions: 
<code><a href='create_schema.html'>create_schema</a>()</code>,
<code><a href='create_table.html'>create_table</a>()</code>,
<code><a href='draft_create_table_from_df.html'>draft_create_table_from_df</a>()</code>,
<code><a href='draft_create_table.html'>draft_create_table</a>()</code></p>
<p>Other table functions: 
<code><a href='appendTable.html'>appendTable</a>()</code>,
<code><a href='append_table.html'>append_table</a>()</code>,
<code><a href='create_table.html'>create_table</a>()</code>,
<code><a href='drop_all_staging_tables.html'>drop_all_staging_tables</a>()</code>,
<code><a href='drop_table_batch.html'>drop_table_batch</a>()</code>,
<code><a href='drop_table.html'>drop_table</a>()</code>,
<code><a href='read_table.html'>read_table</a>()</code>,
<code><a href='searchTable.html'>searchTable</a>()</code>,
<code><a href='search_table.html'>search_table</a>()</code>,
<code><a href='write_staging_table.html'>write_staging_table</a>()</code>,
<code><a href='write_table.html'>write_table</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://meerapatelmd.github.io/pg13/'>pg13</a></span><span class='op'>)</span>
<span class='va'>create_test_schema</span> <span class='op'>&lt;-</span>
        <span class='kw'>function</span><span class='op'>(</span><span class='va'>conn</span><span class='op'>)</span> <span class='op'>{</span>

                <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='schema_exists.html'>schema_exists</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
                                   schema <span class='op'>=</span> <span class='st'>"test_schema"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>

                        <span class='fu'><a href='create_schema.html'>create_schema</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
                                      schema <span class='op'>=</span> <span class='st'>"test_schema"</span><span class='op'>)</span>

                <span class='op'>}</span>
        <span class='op'>}</span>

<span class='va'>conn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='local_connect.html'>local_connect</a></span><span class='op'>(</span>dbname <span class='op'>=</span> <span class='st'>"pg13_test"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Connecting using PostgreSQL driver</span></div><div class='output co'>#&gt; <span class='error'>Error in rJava::.jcall(jdbcDriver, "Ljava/sql/Connection;", "connect",     as.character(url), p): org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.</span></div><div class='input'><span class='fu'>create_test_schema</span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in check_conn_status(conn = conn): object 'conn' not found</span></div><div class='input'>
<span class='co'># Write a table</span>
<span class='fu'><a href='write_table.html'>write_table</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
            schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
            table_name <span class='op'>=</span> <span class='st'>"test_table"</span>,
            drop_existing <span class='op'>=</span> <span class='cn'>TRUE</span>,
            data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, B <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [2021-03-28 22:27:31]	<span style='color: #BBBB00;'>Dropping test_schema.test_table...</span><span></div><div class='output co'>#&gt; <span class='error'>Error in check_conn_status(conn = conn): object 'conn' not found</span></div><div class='input'>
<span class='co'># Write the same table using create_table() instead</span>
<span class='fu'><a href='create_table.html'>create_table</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
             schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
             table_name <span class='op'>=</span> <span class='st'>"test_table_b"</span>,
             if_not_exists <span class='op'>=</span> <span class='cn'>TRUE</span>,
             A <span class='op'>=</span> <span class='st'>"integer"</span>,
             B <span class='op'>=</span> <span class='st'>"varchar(1)"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in check_conn_status(conn = conn): object 'conn' not found</span></div><div class='input'>
<span class='fu'><a href='append_table.html'>append_table</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
             schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
             table <span class='op'>=</span> <span class='st'>"test_table_b"</span>,
             data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, B <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in check_conn_status(conn = conn): object 'conn' not found</span></div><div class='input'>
<span class='co'># Under the hood is the draft_create_table()</span>
<span class='fu'><a href='draft_create_table.html'>draft_create_table</a></span><span class='op'>(</span>schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
                   table_name <span class='op'>=</span> <span class='st'>"test_table_b"</span>,
                   A <span class='op'>=</span> <span class='st'>"integer"</span>,
                   B <span class='op'>=</span> <span class='st'>"varchar(1)"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "\n                                        CREATE TABLE IF NOT EXISTS test_schema.test_table_b (\n                                                A integer,\nB varchar(1)\n                                        );\n                                        "</div><div class='input'>
<span class='co'># The DDL can be automatically discerned using create_table_from_df()</span>
<span class='fu'>create_table_from_df</span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
                     schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
                     table_name <span class='op'>=</span> <span class='st'>"test_table_c"</span>,
                     data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, B <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Unknown levels in `f`: POSIXct, POSIXt, Date, double, numeric</span></div><div class='output co'>#&gt; <span class='error'>Error in check_conn_status(conn = conn): object 'conn' not found</span></div><div class='input'>
<span class='co'># Under the hood is the draft_create_table_from_df()</span>
<span class='fu'><a href='draft_create_table_from_df.html'>draft_create_table_from_df</a></span><span class='op'>(</span>schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
                           table_name <span class='op'>=</span> <span class='st'>"test_table_c"</span>,
                           data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, B <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Unknown levels in `f`: POSIXct, POSIXt, Date, double, numeric</span></div><div class='output co'>#&gt; [1] "\n                                        CREATE TABLE IF NOT EXISTS test_schema.test_table_c (\n                                                A bigint,\nB text\n                                        );\n                                        "</div><div class='input'>
<span class='fu'><a href='drop_schema.html'>drop_schema</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span>,
            schema <span class='op'>=</span> <span class='st'>"test_schema"</span>,
            cascade <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in check_conn_status(conn = conn): object 'conn' not found</span></div><div class='input'>
<span class='fu'><a href='dc.html'>dc</a></span><span class='op'>(</span>conn <span class='op'>=</span> <span class='va'>conn</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [2021-03-28 22:27:31]	Postgres connection was already closed</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Meera Patel, MD.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


